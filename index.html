<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>40x20 Futsal</title>

<style>
body{margin:0;font-family:Arial;background:#f2f4f8}
.app{max-width:480px;margin:auto}
header{background:#071b33;color:#fff;text-align:center;padding:25px}
header img{width:180px}
header span{display:block;margin-top:10px;font-style:italic;opacity:.9}
.screen{display:none;padding:20px}
.active{display:block}
.btn{width:100%;padding:16px;margin-bottom:12px;border:none;border-radius:14px;background:#fff;font-weight:bold}
.btn-back{background:#555;color:#fff}
.card{background:#fff;padding:15px;border-radius:14px}
.tabla{width:100%;border-collapse:collapse}
.tabla th{background:#071b33;color:#fff;padding:10px}
.tabla td{padding:10px;border-bottom:1px solid #ddd}
.fila{display:flex;align-items:center;gap:8px}
.fila img{width:26px}
.partido{border-bottom:1px solid #ddd;padding:10px}
input{width:100%;padding:10px;margin-bottom:8px}
select{width:100%;padding:10px;margin-bottom:8px}
</style>
</head>

<body>
<div class="app">

<header>
<img src="logo.png">
<span>FUTSAL: la pasi√≥n que nos une</span>
</header>

<!-- HOME -->
<div id="home" class="screen active">
<button class="btn" onclick="go('torneos')">TORNEOS</button>
<button class="btn" onclick="go('admin')">ADMIN</button>
</div>

<!-- TORNEOS -->
<div id="torneos" class="screen">
<button class="btn" onclick="go('menu')">LPF</button>
<button class="btn btn-back" onclick="go('home')">Volver</button>
</div>

<!-- MENU -->
<div id="menu" class="screen">
<button class="btn" onclick="verPosiciones()">Posiciones</button>
<button class="btn" onclick="verFixture()">Fixture</button>
<button class="btn" onclick="verGoleadores()">Goleadores</button>
<button class="btn btn-back" onclick="go('torneos')">Volver</button>
</div>

<!-- CONTENIDO -->
<div id="contenido" class="screen">
<div class="card" id="content"></div>
<button class="btn btn-back" onclick="go('menu')">Volver</button>
</div>

<!-- ADMIN -->
<div id="admin" class="screen">
<div class="card">
<h3>Equipos</h3>
<input id="eqNombre" placeholder="Nombre equipo">
<input id="eqEscudo" placeholder="escudo.png">
<button class="btn" onclick="addEquipo()">Agregar equipo</button>

<h3>Cargar partido</h3>
<input id="fFecha" placeholder="Fecha (ej: 1)">
<select id="local"></select>
<select id="visitante"></select>
<input id="gl" placeholder="Goles local">
<input id="gv" placeholder="Goles visitante">
<textarea id="goles" placeholder="Goleadores: Juan 2, Pedro 1"></textarea>
<button class="btn" onclick="addPartido()">Guardar partido</button>
</div>
<button class="btn btn-back" onclick="go('home')">Volver</button>
</div>

</div>

<script>
let equipos=JSON.parse(localStorage.getItem('equipos'))||[];
let partidos=JSON.parse(localStorage.getItem('partidos'))||[];
let goleadores=JSON.parse(localStorage.getItem('goleadores'))||[];

function go(id){
document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
document.getElementById(id).classList.add('active');
}

function save(){
localStorage.setItem('equipos',JSON.stringify(equipos));
localStorage.setItem('partidos',JSON.stringify(partidos));
localStorage.setItem('goleadores',JSON.stringify(goleadores));
}

function addEquipo(){
equipos.push({id:equipos.length+1,nombre:eqNombre.value,escudo:eqEscudo.value,pts:0,gf:0,gc:0});
save(); alert('Equipo agregado'); loadSelects();
}

function loadSelects(){
local.innerHTML=''; visitante.innerHTML='';
equipos.forEach((e,i)=>{
local.innerHTML+=`<option value="${i}">${e.nombre}</option>`;
visitante.innerHTML+=`<option value="${i}">${e.nombre}</option>`;
});
}

function addPartido(){
let f=parseInt(fFecha.value);
let l=parseInt(local.value);
let v=parseInt(visitante.value);
let glv=parseInt(gl.value);
let gvv=parseInt(gv.value);

equipos[l].gf+=glv; equipos[l].gc+=gvv;
equipos[v].gf+=gvv; equipos[v].gc+=glv;

if(glv>gvv) equipos[l].pts+=3;
else if(gvv>glv) equipos[v].pts+=3;
else {equipos[l].pts+=1; equipos[v].pts+=1;}

let lista=goles.value.split(',');
lista.forEach(t=>{
let [nom,cant]=t.trim().split(' ');
let g=goleadores.find(x=>x.nombre===nom);
if(g) g.goles+=parseInt(cant);
else goleadores.push({nombre:nom,goles:parseInt(cant)});
});

partidos.push({fecha:f,l,v,gl:glv,gv:gvv});
save(); alert('Partido cargado');
}

function verPosiciones(){
let ord=[...equipos].sort((a,b)=>b.pts-a.pts||(b.gf-b.gc)-(a.gf-a.gc));
let h='<table class="tabla"><tr><th>#</th><th>Equipo</th><th>PTS</th></tr>';
ord.forEach((e,i)=>{
h+=`<tr><td>${i+1}</td><td class="fila"><img src="escudos/${e.escudo}">${e.nombre}</td><td>${e.pts}</td></tr>`;
});
h+='</table>'; content.innerHTML=h; go('contenido');
}

function verFixture(){
let h='';
let fechas=[...new Set(partidos.map(p=>p.fecha))].sort((a,b)=>a-b);
fechas.forEach(f=>{
h+=`<h4>Fecha ${f}</h4>`;
partidos.filter(p=>p.fecha===f).forEach(p=>{
h+=`<div class="partido">
<div class="fila"><img src="escudos/${equipos[p.l].escudo}">${equipos[p.l].nombre}</div>
<strong>${p.gl} - ${p.gv}</strong>
<div class="fila"><img src="escudos/${equipos[p.v].escudo}">${equipos[p.v].nombre}</div>
</div>`;
});
});
content.innerHTML=h; go('contenido');
}

function verGoleadores(){
let ord=[...goleadores].sort((a,b)=>b.goles-a.goles);
let h='<table class="tabla"><tr><th>Jugador</th><th>Goles</th></tr>';
ord.forEach(g=>h+=`<tr><td>${g.nombre}</td><td>${g.goles}</td></tr>`);
h+='</table>'; content.innerHTML=h; go('contenido');
}

loadSelects();
</script>

</body>
</html>
