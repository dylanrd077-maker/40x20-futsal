<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>40x20 Futsal</title>

<style>
*{box-sizing:border-box;font-family:system-ui}
body{margin:0;background:#f1f3f6}
header{background:#071b33;padding:24px;text-align:center}
header img{width:140px}
header p{color:#cfd8e6;font-style:italic;margin-top:8px}

.container{padding:20px}
.view{display:none}

.btn{
background:#fff;
padding:16px;
border-radius:16px;
margin-bottom:12px;
font-weight:600;
box-shadow:0 6px 18px rgba(0,0,0,.1);
cursor:pointer;
}

.btn-dark{background:#071b33;color:#fff}

.card{
background:#fff;
padding:16px;
border-radius:16px;
box-shadow:0 6px 18px rgba(0,0,0,.1);
margin-bottom:14px;
}

input,select{
width:100%;
padding:12px;
border-radius:12px;
border:1px solid #ccc;
margin-bottom:10px;
}

table{
width:100%;
border-collapse:collapse;
font-size:14px;
}
th,td{padding:6px;text-align:center}
th{background:#e8eef6}

.team{
display:flex;
align-items:center;
gap:6px;
justify-content:left;
}
.team img{width:22px;height:22px;border-radius:50%}
</style>
</head>

<body>

<header>
<img src="IMG_3936.png">
<p>Futsal: la pasión que nos une</p>
</header>

<div class="container">

<!-- HOME -->
<div id="home">
<div class="btn btn-dark" onclick="go('torneos')">TORNEOS</div>
<div class="btn" onclick="go('adminLogin')">PANEL ADMIN</div>
</div>

<!-- TORNEOS -->
<div id="torneos" class="view">
<div class="btn btn-dark" onclick="back()">← Volver</div>
<div class="btn" onclick="openTorneo('LPF')">LPF</div>
<div class="btn" onclick="openTorneo('LAAMBA')">LAAMBA</div>
<div class="btn" onclick="openTorneo('APOFUSA')">A.Po.Fu.Sa</div>
</div>

<!-- MENU TORNEO -->
<div id="menuTorneo" class="view">
<div class="btn btn-dark" onclick="back()">← Volver</div>
<div class="btn" onclick="showTabla()">Tabla de posiciones</div>
<div class="btn" onclick="showFixture()">Fixture</div>
<div class="btn" onclick="showGoleadores()">Goleadores</div>
</div>

<!-- CONTENIDO -->
<div id="contenido" class="view">
<div class="btn btn-dark" onclick="back()">← Volver</div>
<div id="content"></div>
</div>

<!-- LOGIN ADMIN -->
<div id="adminLogin" class="view">
<input type="password" id="adminPass" placeholder="Contraseña admin">
<div class="btn btn-dark" onclick="login()">Entrar</div>
<div class="btn" onclick="back()">Volver</div>
</div>

<!-- ADMIN -->
<div id="admin" class="view">
<div class="btn btn-dark" onclick="back()">← Volver</div>

<div class="card">
<h3>Agregar equipo</h3>
<input id="teamName" placeholder="Nombre del equipo">
<input type="file" id="teamLogo" accept="image/*">
<div class="btn" onclick="addTeam()">Agregar equipo</div>
</div>

<div class="card">
<h3>Agregar partido</h3>
<select id="local"></select>
<select id="visitante"></select>
<input type="number" id="gLocal" placeholder="Goles local">
<input type="number" id="gVisita" placeholder="Goles visitante">
<div class="btn" onclick="addMatch()">Guardar resultado</div>
</div>

<div class="card">
<h3>Importar / Exportar</h3>
<div class="btn" onclick="exportData()">Exportar datos</div>
<input type="file" onchange="importData(event)">
</div>

</div>

</div>

<script>
let history=['home']
let torneoActual=''

let data=JSON.parse(localStorage.getItem('data')) || {
equipos:[],
partidos:[],
goleadores:[]
}

function save(){localStorage.setItem('data',JSON.stringify(data))}

function go(id){
document.querySelectorAll('.view,#home').forEach(v=>v.style.display='none')
document.getElementById(id).style.display='block'
history.push(id)
}

function back(){
history.pop()
let last=history[history.length-1]
document.querySelectorAll('.view,#home').forEach(v=>v.style.display='none')
document.getElementById(last).style.display='block'
}

function openTorneo(t){torneoActual=t;go('menuTorneo')}

/* TABLA */
function showTabla(){
let html=`<div class="card"><h3>Tabla de posiciones</h3>
<table>
<tr><th>Equipo</th><th>PJ</th><th>GF</th><th>GC</th><th>DG</th><th>PTS</th></tr>`

data.equipos.forEach(e=>{
html+=`
<tr>
<td class="team"><img src="${e.logo}">${e.name}</td>
<td>${e.pj}</td>
<td>${e.gf}</td>
<td>${e.gc}</td>
<td>${e.gf-e.gc}</td>
<td><b>${e.pts}</b></td>
</tr>`
})

html+=</table></div>
document.getElementById('content').innerHTML=html
go('contenido')
}

/* FIXTURE */
function showFixture(){
let html='<div class="card"><h3>Resultados</h3>'
data.partidos.forEach(p=>{
html+=<p>${p.local} ${p.gl} - ${p.gv} ${p.visita}</p>
})
html+='</div>'
document.getElementById('content').innerHTML=html
go('contenido')
}

/* GOLEADORES */
function showGoleadores(){
let html='<div class="card"><h3>Goleadores</h3>'
data.goleadores.forEach(g=>{
html+=<p>${g.nombre} (${g.goles})</p>
})
html+='</div>'
document.getElementById('content').innerHTML=html
go('contenido')
}

/* ADMIN */
function login(){
if(document.getElementById('adminPass').value==='admin123'){
loadTeamsSelect()
go('admin')
}else alert('Contraseña incorrecta')
}

function addTeam(){
let name=document.getElementById('teamName').value
let file=document.getElementById('teamLogo').files[0]
if(!name||!file){alert('Completá todo');return}
let r=new FileReader()
r.onload=e=>{
data.equipos.push({name,logo:e.target.result,pj:0,gf:0,gc:0,pts:0})
save()
loadTeamsSelect()
alert('Equipo agregado')
}
r.readAsDataURL(file)
}

function loadTeamsSelect(){
let l=document.getElementById('local')
let v=document.getElementById('visitante')
l.innerHTML=v.innerHTML=''
data.equipos.forEach(e=>{
l.innerHTML+=<option>${e.name}</option>
v.innerHTML+=<option>${e.name}</option>
})
}

function addMatch(){
let l=document.getElementById('local').value
let v=document.getElementById('visitante').value
let gl=parseInt(document.getElementById('gLocal').value)
let gv=parseInt(document.getElementById('gVisita').value)

if(l===v){alert('Equipos iguales');return}

data.partidos.push({local:l,visita:v,gl,gv})

let el=data.equipos.find(e=>e.name===l)
let ev=data.equipos.find(e=>e.name===v)

el.pj++; ev.pj++
el.gf+=gl; el.gc+=gv
ev.gf+=gv; ev.gc+=gl

if(gl>gv) el.pts+=3
else if(gv>gl) ev.pts+=3
else{el.pts++;ev.pts++}

save()
alert('Resultado cargado')
}

function exportData(){
let blob=new Blob([JSON.stringify(data)],{type:'application/json'})
let a=document.createElement('a')
a.href=URL.createObjectURL(blob)
a.download='40x20-datos.json'
a.click()
}

function importData(e){
let f=e.target.files[0]
let r=new FileReader()
r.onload=ev=>{
data=JSON.parse(ev.target.result)
save()
alert('Datos importados')
}
r.readAsText(f)
}
</script>

</body>
</html>
